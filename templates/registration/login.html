{% load static %}

<!DOCTYPE html>
<html lang="en">
	<!--begin::Head-->
	
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
		<!-- Google Tag Manager -->
		<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src= '../../../../../../../www.googletagmanager.com/gtm5445.html?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-5FS8GGP');</script>
		<!-- End Google Tag Manager -->
		<meta charset="utf-8" />
		<title>Đăng nhập</title>
		<meta name="description" content="Login page example" />
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
		<link rel="canonical" href="https://keenthemes.com/metronic" />
		<!--begin::Fonts-->
		<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700" />
		<!--end::Fonts-->
		<!--begin::Page Custom Styles(used by this page)-->
		<link href="{% static 'assets/css/pages/login/classic/login-69cd7.css' %} " rel="stylesheet" type="text/css" />
		<!--end::Page Custom Styles-->
		<!--begin::Global Theme Styles(used by all pages)-->
		<link href="{% static 'assets/plugins/global/plugins.bundle9cd7.css' %} " rel="stylesheet" type="text/css" />
		<link href="{% static 'assets/plugins/custom/prismjs/prismjs.bundle9cd7.css' %} " rel="stylesheet" type="text/css" />
		<link href="{% static 'assets/css/style.bundle9cd7.css' %} " rel="stylesheet" type="text/css" />
		<!--end::Global Theme Styles-->
		<!--begin::Layout Themes(used by all pages)-->
		<link href="{% static 'assets/css/themes/layout/header/base/light9cd7.css' %} " rel="stylesheet" type="text/css" />
		<link href="{% static 'assets/css/themes/layout/header/menu/light9cd7.css' %} " rel="stylesheet" type="text/css" />
		<link href="{% static 'assets/css/themes/layout/brand/dark9cd7.css' %} " rel="stylesheet" type="text/css" />
		<link href="{% static 'assets/css/themes/layout/aside/dark9cd7.css' %} " rel="stylesheet" type="text/css" />
		<!--end::Layout Themes-->
		<link rel="shortcut icon" href="{% static 'assets/media/logos/logo.ico' %} " />
		<!-- Hotjar Tracking Code for keenthemes.com -->
		<script>(function(h,o,t,j,a,r){ h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)}; h._hjSettings={hjid:1070954,hjsv:6}; a=o.getElementsByTagName('head')[0]; r=o.createElement('script');r.async=1; r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv; a.appendChild(r); })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');</script>
	</head>
	<!--end::Head-->
	<!--begin::Body-->
	<body id="kt_body" class="header-fixed header-mobile-fixed subheader-enabled subheader-fixed aside-enabled aside-fixed aside-minimize-hoverable page-loading">
		<!-- Google Tag Manager (noscript) -->
		<noscript>
			<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5FS8GGP" height="0" width="0" style="display:none;visibility:hidden"></iframe>
		</noscript>
		<!-- End Google Tag Manager (noscript) -->
		<!--begin::Main-->
		<div class="d-flex flex-column flex-root">
			<!--begin::Login-->
			<div class="login login-6 login-signin-on login-signin-on d-flex flex-column-fluid" id="kt_login">
				<div class="d-flex flex-column flex-lg-row flex-row-fluid text-center" style="background-image: url({% static 'assets/media/bg/bg-3.jpg' %} );">
					<!--begin:Aside-->
					<div class="d-flex w-100 flex-center p-15">
						<div class="login-wrapper">
							<!--begin:Aside Content-->
							<div class="text-dark-75">
								<a href="#">
									<img src="{% static 'assets/media/logos/logo.png' %} " class="max-h-125px" alt="" />
								</a>
								<h3 class="mb-8 mt-22 font-weight-bold">NIO VIETNAM</h3>
								<p class="mb-15 text-muted font-weight-bold">Phần mềm quản lý phòng khám</p>
								{% comment %} <button type="button" id="kt_login_signup" class="btn btn-outline-primary btn-pill py-4 px-9 font-weight-bold">Get An Account</button> {% endcomment %}
							</div>
							<!--end:Aside Content-->
						</div>
					</div>
					<!--end:Aside-->
					<!--begin:Divider-->
					<div class="login-divider">
						<div></div>
					</div>
					<!--end:Divider-->
					<!--begin:Content-->
					<div class="d-flex w-100 flex-center p-15 position-relative overflow-hidden">
						<div class="login-wrapper">
							<!--begin:Sign In Form-->
							<div class="login-signin">
								<div class="text-center mb-10 mb-lg-20">
									<h2 class="font-weight-bold">Đăng Nhập</h2>
									<p class="text-muted font-weight-bold">Nhập Số Điện Thoại Và Mật Khẩu</p>
								</div>
                
								<form class="form text-left" id="kt_login_signin_form" method="POST">
									{% csrf_token %}
									<div class="form-group py-2 m-0">
										<input id="input-phone" class="form-control h-auto border-0 px-0 placeholder-dark-75" type="text" placeholder="Số Điện Thoại" name="so_dien_thoai" autocomplete="off" />
									</div>
									<div class="form-group py-2 border-top m-0">
										<input id="input-password" class="form-control h-auto border-0 px-0 placeholder-dark-75" type="Password" placeholder="Mật Khẩu" name="password" />
									</div>
									<div class="form-group d-flex flex-wrap justify-content-between align-items-center mt-5">
										<div class="checkbox-inline">
											<label class="checkbox m-0 text-muted font-weight-bold">
											<input type="checkbox" name="remember" />
											<span></span>Ghi Nhớ Đăng Nhập</label>
										</div>
										<a href="javascript:;" id="kt_login_forgot" class="text-muted text-hover-primary font-weight-bold">Quên Mật Khẩu ?</a>
									</div> 
									<div class="text-center mt-15">
										<button type="button" id="login-button" class="btn btn-primary btn-pill shadow-sm py-4 px-9 font-weight-bold">Đăng Nhập</button>
									</div>
								</form>
							</div>
							<!--end:Sign In Form-->
							<!--begin:Forgot Password Form-->
							<div class="login-forgot">
								<div class="text-center mb-10 mb-lg-20">
									<h3 class="">Quên mật khẩu ?</h3>
									<p class="text-muted font-weight-bold">Nhập email của bạn để lấy lại mật khẩu</p>
								</div>
								<form class="form text-left" id="kt_login_forgot_form">
									<div class="form-group py-2 m-0 border-bottom">
										<input class="form-control h-auto border-0 px-0 placeholder-dark-75" type="text" placeholder="Email" name="email" autocomplete="off" />
									</div>
									<div class="form-group d-flex flex-wrap flex-center mt-10">
										<button id="kt_login_forgot_submit" class="btn btn-primary btn-pill font-weight-bold px-9 py-4 my-3 mx-2">Xác nhận</button>
										<button id="kt_login_forgot_cancel" class="btn btn-outline-primary btn-pill font-weight-bold px-9 py-4 my-3 mx-2">Hủy</button>
									</div>
								</form>
							</div>
							<!--end:Forgot Password Form-->
						</div>
					</div>
					<!--end:Content-->
				</div>
			</div>
			<!--end::Login-->
		</div>
		<!--end::Main-->
		<!--begin::Global Config(global config for global JS scripts)-->
		<script>var KTAppSettings = { "breakpoints": { "sm": 576, "md": 768, "lg": 992, "xl": 1200, "xxl": 1400 }, "colors": { "theme": { "base": { "white": "#ffffff", "primary": "#3699FF", "secondary": "#E5EAEE", "success": "#1BC5BD", "info": "#8950FC", "warning": "#FFA800", "danger": "#F64E60", "light": "#E4E6EF", "dark": "#181C32" }, "light": { "white": "#ffffff", "primary": "#E1F0FF", "secondary": "#EBEDF3", "success": "#C9F7F5", "info": "#EEE5FF", "warning": "#FFF4DE", "danger": "#FFE2E5", "light": "#F3F6F9", "dark": "#D6D6E0" }, "inverse": { "white": "#ffffff", "primary": "#ffffff", "secondary": "#3F4254", "success": "#ffffff", "info": "#ffffff", "warning": "#ffffff", "danger": "#ffffff", "light": "#464E5F", "dark": "#ffffff" } }, "gray": { "gray-100": "#F3F6F9", "gray-200": "#EBEDF3", "gray-300": "#E4E6EF", "gray-400": "#D1D3E0", "gray-500": "#B5B5C3", "gray-600": "#7E8299", "gray-700": "#5E6278", "gray-800": "#3F4254", "gray-900": "#181C32" } }, "font-family": "Poppins" };</script>
		<!--end::Global Config-->
		<!--begin::Global Theme Bundle(used by all pages)-->
		<script src="{% static 'assets/plugins/global/plugins.bundle9cd7.js' %} "></script>
		<script src="{% static 'assets/plugins/custom/prismjs/prismjs.bundle9cd7.js' %} "></script>
		<script src="{% static 'assets/js/scripts.bundle9cd7.js' %} "></script>
		<!--end::Global Theme Bundle-->
		<!--begin::Page Scripts(used by this page)-->
		<script>
			"use strict";

			// Class Definition
			var KTLogin = function() {
				var _login;

				var _showForm = function(form) {
					var cls = 'login-' + form + '-on';
					var form = 'kt_login_' + form + '_form';

					_login.removeClass('login-forgot-on');
					_login.removeClass('login-signin-on');
					_login.removeClass('login-signup-on');

					_login.addClass(cls);

					KTUtil.animateClass(KTUtil.getById(form), 'animate__animated animate__backInUp');
				}

				var _handleSignInForm = function() {
					var validation;

					// Init form validation rules. For more info check the FormValidation plugin's official documentation:https://formvalidation.io/
					validation = FormValidation.formValidation(
						KTUtil.getById('kt_login_signin_form'),
						{
							fields: {
								so_dien_thoai: {
									validators: {
										notEmpty: {
											message: 'Số Điện Thoại Không Được Để Trống'
										}
									}
								},
								password: {
									validators: {
										notEmpty: {
											message: 'Yêu Cầu Mật Khẩu'
										}
									}
								}
							},
							plugins: {
								trigger: new FormValidation.plugins.Trigger(),
								submitButton: new FormValidation.plugins.SubmitButton(),
								//defaultSubmit: new FormValidation.plugins.DefaultSubmit(), // Uncomment this line to enable normal button submit after form validation
								bootstrap: new FormValidation.plugins.Bootstrap()
							}
						}
					);

					$('#kt_login_signin_submit').on('click', function (e) {
						e.preventDefault();

						validation.validate().then(function(status) {
							if (status == 'Valid') {
								swal.fire({
									text: "All is cool! Now you submit this form",
									icon: "success",
									buttonsStyling: false,
									confirmButtonText: "Ok, got it!",
									customClass: {
										confirmButton: "btn font-weight-bold btn-light-primary"
									}
								}).then(function() {
									KTUtil.scrollTop();
								});
							} else {
								swal.fire({
									text: "Sorry, looks like there are some errors detected, please try again.",
									icon: "error",
									buttonsStyling: false,
									confirmButtonText: "Ok, got it!",
									customClass: {
										confirmButton: "btn font-weight-bold btn-light-primary"
									}
								}).then(function() {
									KTUtil.scrollTop();
								});
							}
						});
					});

					// Handle forgot button
					$('#kt_login_forgot').on('click', function (e) {
						e.preventDefault();
						_showForm('forgot');
					});

					// Handle signup
					$('#kt_login_signup').on('click', function (e) {
						e.preventDefault();
						_showForm('signup');
					});
				}

				var _handleSignUpForm = function(e) {
					var validation;
					var form = KTUtil.getById('kt_login_signup_form');

					// Init form validation rules. For more info check the FormValidation plugin's official documentation:https://formvalidation.io/
					validation = FormValidation.formValidation(
						form,
						{
							fields: {
								fullname: {
									validators: {
										notEmpty: {
											message: 'Username is required'
										}
									}
								},
								email: {
									validators: {
										notEmpty: {
											message: 'Email address is required'
										},
										emailAddress: {
											message: 'The value is not a valid email address'
										}
									}
								},
								password: {
									validators: {
										notEmpty: {
											message: 'The password is required'
										}
									}
								},
								cpassword: {
									validators: {
										notEmpty: {
											message: 'The password confirmation is required'
										},
										identical: {
											compare: function() {
												return form.querySelector('[name="password"]').value;
											},
											message: 'The password and its confirm are not the same'
										}
									}
								},
								agree: {
									validators: {
										notEmpty: {
											message: 'You must accept the terms and conditions'
										}
									}
								},
							},
							plugins: {
								trigger: new FormValidation.plugins.Trigger(),
								bootstrap: new FormValidation.plugins.Bootstrap()
							}
						}
					);

					$('#kt_login_signup_submit').on('click', function (e) {
						e.preventDefault();

						validation.validate().then(function(status) {
							if (status == 'Valid') {
								swal.fire({
									text: "All is cool! Now you submit this form",
									icon: "success",
									buttonsStyling: false,
									confirmButtonText: "Ok, got it!",
									customClass: {
										confirmButton: "btn font-weight-bold btn-light-primary"
									}
								}).then(function() {
									KTUtil.scrollTop();
								});
							} else {
								swal.fire({
									text: "Sorry, looks like there are some errors detected, please try again.",
									icon: "error",
									buttonsStyling: false,
									confirmButtonText: "Ok, got it!",
									customClass: {
										confirmButton: "btn font-weight-bold btn-light-primary"
									}
								}).then(function() {
									KTUtil.scrollTop();
								});
							}
						});
					});

					// Handle cancel button
					$('#kt_login_signup_cancel').on('click', function (e) {
						e.preventDefault();

						_showForm('signin');
					});
				}

				var _handleForgotForm = function(e) {
					var validation;

					// Init form validation rules. For more info check the FormValidation plugin's official documentation:https://formvalidation.io/
					validation = FormValidation.formValidation(
						KTUtil.getById('kt_login_forgot_form'),
						{
							fields: {
								email: {
									validators: {
										notEmpty: {
											message: 'Email address is required'
										},
										emailAddress: {
											message: 'The value is not a valid email address'
										}
									}
								}
							},
							plugins: {
								trigger: new FormValidation.plugins.Trigger(),
								bootstrap: new FormValidation.plugins.Bootstrap()
							}
						}
					);

					// Handle submit button
					$('#kt_login_forgot_submit').on('click', function (e) {
						e.preventDefault();

						validation.validate().then(function(status) {
							if (status == 'Valid') {
								// Submit form
								KTUtil.scrollTop();
							} else {
								swal.fire({
									text: "Sorry, looks like there are some errors detected, please try again.",
									icon: "error",
									buttonsStyling: false,
									confirmButtonText: "Ok, got it!",
									customClass: {
										confirmButton: "btn font-weight-bold btn-light-primary"
									}
								}).then(function() {
									KTUtil.scrollTop();
								});
							}
						});
					});

					// Handle cancel button
					$('#kt_login_forgot_cancel').on('click', function (e) {
						e.preventDefault();

						_showForm('signin');
					});
				}

				$('#login-button').on('click', function(){
					var so_dien_thoai = $('#input-phone').val()
					var password      = $('#input-password').val()
					var csrf_token    = document.getElementsByName('csrfmiddlewaretoken')[0].value
					$.ajax({
						type:"POST",
						url:'{% url 'loginUser' %}',
						data:{
							'csrfmiddlewaretoken': csrf_token,
							'so_dien_thoai'      : so_dien_thoai,
							'password'           : password,
						},
						success : function(data){
							console.log(data);
							if(data['message'] == "Success"){
								location = data.url
							}
							else if(data['message'] == "inactive"){
								$("#errorlogin").html("Please verify this E-mail address.");
							}
							else{
								$("#errorlogin").html("The E-mail and Password do not match.");
							}
						}
					});
					
				})

				// Public Functions
				return {
					// public functions
					init: function() {
						_login = $('#kt_login');

						_handleSignInForm();
						_handleSignUpForm();
						_handleForgotForm();
					}
				};
			}();

			// Class Initialization
			jQuery(document).ready(function() {
				KTLogin.init();
			});

		</script>
		<!--end::Page Scripts-->
	</body>
	<!--end::Body-->

</html>